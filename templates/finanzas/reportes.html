{% extends "finanzas/base.html" %}

{% block title %}Reportes - Mis Finanzas{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">ðŸ“Š Reportes y EstadÃ­sticas</h1>
</div>

<div class="reportes-container">
    <!-- Resumen por categorÃ­as -->
    <div class="report-section">
        <h2>ðŸ’µ Ingresos por CategorÃ­a</h2>
        <div class="category-stats">
            {% if ingresos_categoria %}
                {% for item in ingresos_categoria %}
                <div class="category-item income-category">
                    <div class="category-name">{{ item.categoria or 'Sin categorÃ­a' }}</div>
                    <div class="category-amount">${{ "%.2f"|format(item.total) }}</div>
                </div>
                {% endfor %}
            {% else %}
                <p class="empty-message">No hay datos de ingresos</p>
            {% endif %}
        </div>
    </div>

    <div class="report-section">
        <h2>ðŸ’¸ Gastos por CategorÃ­a</h2>
        <div class="category-stats">
            {% if gastos_categoria %}
                {% for item in gastos_categoria %}
                <div class="category-item expense-category">
                    <div class="category-name">{{ item.categoria or 'Sin categorÃ­a' }}</div>
                    <div class="category-amount">${{ "%.2f"|format(item.total) }}</div>
                </div>
                {% endfor %}
            {% else %}
                <p class="empty-message">No hay datos de gastos</p>
            {% endif %}
        </div>
    </div>

    <!-- Tendencia mensual -->
    <div class="report-section full-width">
        <h2>ðŸ“ˆ Tendencia Mensual (Ãšltimos 6 Meses)</h2>
        {% if tendencia %}
        <div class="tendencia-table">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Mes</th>
                        <th>Ingresos</th>
                        <th>Gastos</th>
                        <th>Balance</th>
                    </tr>
                </thead>
                <tbody>
                    {% for mes in tendencia %}
                    {% set balance = mes.ingresos - mes.gastos %}
                    <tr>
                        <td><strong>{{ mes.mes }}</strong></td>
                        <td class="amount-positive">${{ "%.2f"|format(mes.ingresos) }}</td>
                        <td class="amount-negative">${{ "%.2f"|format(mes.gastos) }}</td>
                        <td class="{% if balance >= 0 %}amount-positive{% else %}amount-negative{% endif %}">
                            ${{ "%.2f"|format(balance) }}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
            <p class="empty-message">No hay suficientes datos para mostrar tendencias</p>
        {% endif %}
    </div>

    <!-- InformaciÃ³n adicional -->
    <div class="report-section full-width info-cards">
        <div class="info-card">
            <div class="info-icon">ðŸ’¡</div>
            <div class="info-content">
                <h3>Consejo Financiero</h3>
                <p>MantÃ©n tus gastos por debajo del 70% de tus ingresos y destina al menos un 20% al ahorro.</p>
            </div>
        </div>
        <div class="info-card">
            <div class="info-icon">ðŸŽ¯</div>
            <div class="info-content">
                <h3>Meta Sugerida</h3>
                <p>Crea un fondo de emergencia equivalente a 3-6 meses de tus gastos mensuales.</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

